
#from santalucia2004

# GC
# CT

import random


hs = {
    'G':    {'A': {'A':{'H': -2.9, 'S': -9.8}, 'C':{'H': +5.2, 'S': 14.2}, 'G':{'H': -0.6, 'S': -1.0}, 'T':{'H': -8.2,   'S': -22.2}},
             'C': {'A':{'H': -0.7, 'S': -3.8}, 'C':{'H': +3.6, 'S': +8.9}, 'G':{'H': -9.8,   'S': -24.4}, 'T':{'H': +2.3, 'S': +5.4}},
             'G': {'A':{'H': +0.5, 'S': +3.2}, 'C':{'H': -8.0, 'S': -19.9}, 'G':{'H': -6.0, 'S': -15.8}, 'T':{'H': +3.3, 'S': +10.4}},
             'T': {'A':{'H': -8.4, 'S': -22.4}, 'C':{'H': +5.2, 'S': 13.5}, 'G':{'H': -4.4, 'S': -12.3}, 'T':{'H': -2.2, 'S': -8.4}}},

    'C':    {'A': {'A':{'H': - 0.9, 'S': -4.2}, 'C':{'H': +1.9, 'S': +3.7}, 'G':{'H': -0.7, 'S': -2.3}, 'T':{'H': -8.5, 'S': -22.7}},
             'C': {'A':{'H': +0.6, 'S': -0.6}, 'C':{'H': -1.5, 'S': -7.2}, 'G':{'H': -8.0,  'S': -19.9}, 'T':{'H': -0.8, 'S': -4.5}},
             'G': {'A':{'H': -4.0, 'S': -13.2}, 'C':{'H': -10.6,  'S': -27.2}, 'G':{'H': -4.9, 'S': -15.3}, 'T':{'H': -4.1, 'S': -11.7}},
             'T': {'A':{'H': -7.8,   'S': -21.0}, 'C':{'H': -1.5, 'S': -6.1}, 'G':{'H': -2.8, 'S': -8.0}, 'T':{'H': -5.0, 'S': -15.8}}},

    'A':    {'A': {'A':{'H': +1.2, 'S': +1.7}, 'C':{'H': +2.3, 'S': +4.6}, 'G':{'H': -0.6, 'S': -2.3}, 'T':{'H': -7.6,   'S': -21.3}},
             'C': {'A':{'H': +5.3, 'S': 14.6}, 'C':{'H': +0.0, 'S': -4.4}, 'G':{'H': -8.5,   'S': -22.7}, 'T':{'H': +0.7, 'S': +0.2}},
             'G': {'A':{'H': -0.7, 'S': -2.3}, 'C':{'H': -7.8,   'S': -21.0}, 'G':{'H': -3.1, 'S': -9.5}, 'T':{'H': +1.0, 'S': +0.9}},
             'T': {'A':{'H': -7.2,   'S': -20.4}, 'C':{'H': -1.2, 'S': -6.2}, 'G':{'H': -2.5, 'S': -8.3}, 'T':{'H': -2.7, 'S': -10.8}}},
             
    'T':    {'A': {'A':{'H': +4.7, 'S': 12.9}, 'C':{'H': +3.4, 'S': +8.0}, 'G':{'H': +0.7, 'S': +0.7}, 'T':{'H': -7.2,   'S': -21.3}},
             'C': {'A':{'H': +7.6, 'S': 20.2}, 'C':{'H': +6.1, 'S': 16.4}, 'G':{'H': -7.8,   'S': -21.0}, 'T':{'H': +1.2, 'S': +0.7}},
             'G': {'A':{'H': +3.0, 'S': +7.4}, 'C':{'H': -8.5,   'S': -22.7}, 'G':{'H': +1.6, 'S': +3.6}, 'T':{'H': -0.1, 'S': -1.7}},
             'T': {'A':{'H': -7.6,   'S': -21.3}, 'C':{'H': +1.0, 'S': +0.7}, 'G':{'H': -1.3, 'S': -5.3}, 'T':{'H': +0.2, 'S': -1.5}}},
    'initiation':           {'H': +0.2,     'S': -5.7},
    'TerminalATPenalty':    {'H': +2.2,     'S': +6.9},
    }

ab = {
    'GUG':  {'A':-4.3,'C':-3,'G':-5.7,'T':-4.5},
    'CUC':  {'A':-7.6,'C':-11.3,'G':-8.3,'T':-11.3},
    }

# You don't count dangling end contribution
# when the last basepair is mismatched
dangling = {

'5':{           'A':{   'A':{  
                        'T':{'H':0.2,'S':2.3}},

                        'C':{  
                        'G':{'H':-6.3,'S':-17.1}},

                        'G':{  
                        'C':{'H':-3.7,'S':-10}},

                        'T':{  
                        'A':{'H':-2.9,'S':-7.6}}},

                'C':{   'A':{  
                        'T':{'H':0.6,'S':3.3}},

                        'C':{  
                        'G':{'H':-4.4,'S':-12.6}},

                        'G':{  
                        'C':{'H':-4,'S':-11.9}},

                        'T':{  
                        'A':{'H':-4.1,'S':-13}}},

                'G':{   'A':{  
                        'T':{'H':-1.1,'S':-1.6}},

                        'C':{  
                        'G':{'H':-5.1,'S':-14}},

                        'G':{  
                        'C':{'H':-3.9,'S':-10.9}},

                        'T':{  
                        'A':{'H':-4.2,'S':-15.0}}},
                        
                'T':{   'A':{
                        'T':{'H':-6.9,'S':-20}},

                        'C':{  
                        'G':{'H':-4.0,'S':-10.9}},

                        'G':{  
                        'C':{'H':-4.9,'S':-13.8}},

                        'T':{  
                        'A':{'H':-0.2,'S':-0.5}}}},

'3':{           'A':{   'T':{  
                        'A':{'H':-0.7,'S':-0.8}},

                        'G':{  
                        'C':{'H':-2.1,'S':-3.9}},

                        'C':{  
                        'G':{'H':-5.9,'S':-16.5}},

                        'A':{  
                        'T':{'H':-0.5,'S':-1.1}}},

                'C':{   'T':{ 
                        'A':{'H':4.4,'S':14.9}},

                        'G':{  
                        'C':{'H':-0.2,'S':-0.1}},

                        'C':{ 
                        'G':{'H':-2.6,'S':-7.4}},

                        'A':{  
                        'T':{'H':4.7,'S':14.2}}},

                'G':{   'T':{  
                        'A':{'H':-1.6,'S':-3.6}},

                        'G':{  
                        'C':{'H':-3.9,'S':-11.2}},

                        'C':{  
                        'G':{'H':-3.2,'S':-10.4}},

                        'A':{  
                        'T':{'H':-4.1,'S':-13.1}}},
                        
                'T':{   'T':{  
                        'A':{'H':2.9,'S':10.4}},

                        'G':{  
                        'C':{'H':-4.4,'S':-13.1}},

                        'C':{  
                        'G':{'H':-5.2,'S':-15.0}},

                        'A':{  
                        'T':{'H':-3.8,'S':-12.6}}}}
}

#terminal GT stabilizes between -0.4 and -1.0 kcal/mol Allawi&SantaLucia1997
avg_GT = (1+0.4)/2
var_GT = (1-0.4)/2
terminal_GT = -random.gauss(avg_GT,var_GT)

#GA mismatch is more stable than gc by about -0.4 and -0.3 kcal/mol Allawi&SantaLucia1998
avg_GA = avg_GT + (0.4+0.3)/2
var_GA = var_GT
terminal_ga = -random.gauss(avg_GA,var_GA)

#AC mismatches are about the same as GT mismatches Allawi&SantaLucia1998
terminal_AC = -random.gauss(avg_GT,var_GT)

# CT mismatches are the most destabilizing ones, we also know that 
# all terminal mismatches are stabilizing, hence since the lowest
# value given for this situation in SantaLucia2004 is -0.21 kcal/mol
# I'll use that value as a reference for terminal CT mismatches
avg_CT = 0.21
var_CT = 0.1
terminal_CT = -random.gauss(avg_CT,var_CT)


##Deprecated
# wc = {
    # 'AA': {'H': -7.6,   'S': -21.3},
    # 'TT': {'H': -7.6,   'S': -21.3},
    # 'AT': {'H': -7.2,   'S': -20.4},
    # 'TA': {'H': -7.2,   'S': -21.3},
    # 'CA': {'H': -8.5,   'S': -22.7},
    # 'AC': {'H': -8.5,   'S': -22.7},
    # 'GT': {'H': -8.4,   'S': -22.4},
    # 'TG': {'H': -8.4,   'S': -22.4},
    # 'CT': {'H': -7.8,   'S': -21.0},
    # 'TC': {'H': -7.8,   'S': -21.0},
    # 'GA': {'H': -8.2,   'S': -22.2},
    # 'AG': {'H': -8.2,   'S': -22.2},
    # 'CG': {'H': -10.6,  'S': -27.2},
    # 'GC': {'H': -9.8,   'S': -24.4},
    # 'GG': {'H': -8.0,   'S': -19.9},
    # 'CC': {'H': -8.0,   'S': -19.9},
    # 'initiation':           {'H': +0.2,     'S': -5.7},
    # 'TerminalATPenalty':    {'H': +2.2,     'S': +6.9},
    # 'SymmetryCorr':         {'H': 0,        'S': -1.4},
    # }